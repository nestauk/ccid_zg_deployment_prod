(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[97],{7251:function(e,i,s){Promise.resolve().then(s.bind(s,26983))},26983:function(e,i,s){"use strict";s.r(i),s.d(i,{default:function(){return eu}});var n,t,l,o,r=s(57437),a=s(96537),d=s(88620),c=s(2265),u=s(67022),h=s(20920);let x=(0,c.createContext)({});function p(e){var i;let[s,n]=(0,c.useState)((null===(i=window)||void 0===i?void 0:i.localStorage.getItem("DeviceId"))||(0,h.Z)());(0,c.useEffect)(()=>{window&&window.localStorage.setItem("DeviceId",s)},[s]);let[t,l]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[f,v]=(0,c.useState)(e.role),g=(0,u.aC)(),m=async()=>{await g.signoutSilent(),p(null)},[j,b]=(0,c.useState)({user:o,role:f,deviceId:s,onSignOut:m});(0,c.useEffect)(()=>{b({...j,role:f})},[f]),(0,c.useEffect)(()=>{b({...j,deviceId:s})},[s]),(0,c.useEffect)(()=>{b({...j,user:o})},[o]);let y=async()=>{try{l(!0);let e=await g.signinSilent();null===e?await g.signinRedirect():p(e)}finally{l(!1)}};return(0,c.useEffect)(()=>{!g.isLoading&&g.user&&p(g.user)},[g.isLoading]),(0,r.jsxs)(r.Fragment,{children:[(t||g.isLoading)&&(0,r.jsx)(d.Z,{isError:!1,isBusy:!0,title:"Checking authentication...",message:"Please wait while we confirm permission to access the facilitator overview.",showProgress:!1}),!g.isLoading&&!t&&(0,r.jsxs)(r.Fragment,{children:[null===o&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.Z,{isError:!1,isBusy:!1,title:"Please sign in",message:"Please sign in to use the facilitator overview.",showProgress:!1,children:(0,r.jsx)(a.Z,{variant:"contained",onClick:()=>y(),disabled:t,children:"Sign in"})})}),(null==o?void 0:o.expired)&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.Z,{isError:!0,isBusy:!1,title:"Authentication expired",message:"Please sign in again to use the facilitator overview.",showProgress:!1,children:(0,r.jsx)(a.Z,{variant:"contained",onClick:()=>y(),disabled:t,children:"Sign in"})})}),null!==j.user&&!j.user.expired&&(0,r.jsx)(x.Provider,{value:j,children:e.children})]})]})}var f=s(94547),v=s(58433);function g(e){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(v.ZP,{container:!0,sx:{...e.sx,height:"100vh",p:1},children:[(0,r.jsx)(v.ZP,{item:!0,xs:2,sx:{overflowY:"auto",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:e.menu}),(0,r.jsx)(v.ZP,{item:!0,xs:10,sx:{overflowY:"scroll"},children:e.children})]})})}var m=s(32184),j=s(57300),b=s(80511),y=s(27270);function Z(){let e=(0,c.useContext)(x);return(0,r.jsx)(r.Fragment,{children:e.user.profile.email})}function w(e){let[i,s]=(0,c.useState)(0),n=(0,c.useContext)(x);return(0,c.useEffect)(()=>{console.log("Selection",l[i]),s(i)},[i]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{children:void 0!==e.options.find(e=>0==e)&&(0,r.jsx)(j.Z,{onClick:()=>s(0),selected:0==i,children:(0,r.jsxs)(b.Z,{variant:"h5",children:[(0,r.jsx)("img",{src:"/icons/workshops.svg",style:{height:26,verticalAlign:"middle",marginRight:12}}),"Workshops"]})})}),e.showUsername&&(0,r.jsxs)(y.Z,{severity:"success",action:e.showSignOut?(0,r.jsx)(a.Z,{color:"inherit",size:"small",onClick:n.onSignOut,children:"Sign out"}):void 0,children:["Signed in as: ",(0,r.jsx)(Z,{})]})]})}(n=l||(l={}))[n.Workshops=0]="Workshops";var S=s(58253),D=s(20909),k=s(79393),C=s(31193),T=s(99128),E=s(45133),W=s(47905),P=s(63742),A=s(16463),R=s(10105),I=s(7547),q=s(19783);let F=(e,i)=>new Date(new Date(e).getTime()+6e4*i),_=e=>{window.open((0,R.k)(e),"_blank","noreferrer")};function N(e){var i,s,n;let[t,l]=(0,c.useState)();return(0,c.useEffect)(()=>{q.toDataURL((0,R.v)(e.session)).then(e=>{l(e)}).catch(e=>{l(void 0),console.error(e)})},[e.session]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",alignItems:"flex-start",sx:{mb:2},children:[t&&(0,r.jsx)(C.Z,{sx:{mr:2},children:(0,r.jsx)("img",{src:t,style:{width:150,height:150}})}),(0,r.jsxs)(C.Z,{display:"flex",flexGrow:1,flexDirection:"column",sx:{mr:4},children:[(0,r.jsx)(b.Z,{variant:"h4",children:e.session.sessionName}),(0,r.jsx)(b.Z,{variant:"body1",sx:{mt:1},children:e.session.sessionDescription})]}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1,children:(0,r.jsx)(a.Z,{fullWidth:!0,variant:"outlined",color:"buttonStandard",onClick:()=>e.onEditSession(e.session),children:"Edit"})})]}),(0,r.jsxs)(m.Z,{children:[(0,r.jsx)(I.ZP,{children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-type.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"TYPE"}),(0,r.jsxs)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:[f.VS[e.session.remoteConfiguration]," ",f.EQ[e.session.audience]]})]})]})}),e.session.location&&(0,r.jsx)(I.ZP,{children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-location.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"LOCATION"}),(0,r.jsx)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:null!==(i=e.session.location)&&void 0!==i?i:"(not specified)"})]})]})}),(0,r.jsx)(I.ZP,{children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-date.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"DATE"}),(0,r.jsx)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:new Date(e.session.sessionStartTime).toISOString().substring(0,10)})]})]})}),(0,r.jsx)(I.ZP,{children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-time.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"TIME"}),(0,r.jsx)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:"".concat(new Date(e.session.sessionStartTime).toLocaleTimeString()," - ").concat(F(e.session.sessionStartTime,e.session.sessionDurationMins).toLocaleTimeString())})]})]})}),(0,r.jsx)(I.ZP,{children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-participants.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"PARTICIPANTS"}),(0,r.jsx)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:null!==(s=e.session.anticipatedParticipants)&&void 0!==s?s:"(not specified)"})]})]})}),(0,r.jsx)(I.ZP,{children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-participants.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"FACILITATOR"}),(0,r.jsx)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:null!==(n=e.session.facilitatorEmail)&&void 0!==n?n:"(not specified)"})]})]})}),(0,r.jsx)(j.Z,{onClick:()=>{var i;null===(i=navigator)||void 0===i||i.clipboard.writeText((0,R.v)(e.session))},children:(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",children:[(0,r.jsx)("img",{src:"/icons/session-type.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"column",children:[(0,r.jsx)(b.Z,{variant:"body2",children:"JOIN CODE"}),(0,r.jsx)(b.Z,{variant:"body1",style:{fontWeight:"bold"},children:e.session.joinCode})]})]})})]}),(0,r.jsxs)(C.Z,{sx:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"stretch",gap:2,pt:1,borderTop:"solid 1px black"},children:[(0,r.jsx)(a.Z,{variant:"contained",color:"buttonStandard",sx:{flexGrow:1},onClick:()=>_(e.session),children:"Enter workshop"}),(0,r.jsx)(a.Z,{variant:"contained",color:"buttonStandard",sx:{flexGrow:1},onClick:()=>{var i;null===(i=navigator)||void 0===i||i.clipboard.writeText((0,R.v)(e.session))},children:"Copy participant link"})]})]})}var O=s(69065),L=s(66124),z=s(60335),G=s(18502),Q=s(80824),U=s(28549),M=s(56065),V=s(19004),B=s(11656),Y=s(66858),H=s(98784),X=s(7630),J=s(54952),K=s(39986),$=s(5069),ee=s(62737),ei=s.n(ee),es=s(47109),en=s(24072),et=s(76396);let el=[{title:"Zeitgeist demo",description:"A Zeitgeist demonstration workshop.",duration_mins:15,audience:f.EQ.DemoWorkshop,slug:"zg-demo",uris:["/workshops/zg-demo/presentation.xml"]},{title:"Zeitgeist gallery",description:"A Zeitgeist gallery workshop (for testing).",duration_mins:15,audience:f.EQ.TestingWorkshop,slug:"zg-gallery",uris:["/workshops/zg-welcome/presentation.xml","/workshops/zg-gallery/presentation.xml"]},{title:"Situation Room: Water Scarcity",description:"The Situation Room, covering the Water Scarcity topic.",duration_mins:120,audience:f.EQ.LiveWorkshop,slug:"sr-water-scarcity",uris:["/workshops/sr-a-intro/presentation.xml","/workshops/sr-b-water-scarcity/0-start.xml","/workshops/sr-b-water-scarcity/1-reuse.xml","/workshops/sr-b-water-scarcity/2-reduce.xml","/workshops/sr-b-water-scarcity/3-restrict.xml","/workshops/sr-b-water-scarcity/4-end.xml","/workshops/sr-z-outro/presentation.xml"]}];Object.values(f.VS).filter(e=>!isNaN(Number(e))).map(e=>Number(e));let eo=[{value:f.EQ.LiveWorkshop,title:"Live workshop",description:"A live session with real participants."},{value:f.EQ.DemoWorkshop,title:"Demo workshop",description:"A demonstration workshop."},{value:f.EQ.TestingWorkshop,title:"Test workshop",description:"A test workshop, to review content or test new features."}],er=e=>{let i=parseInt(e);return isNaN(i)?void 0:i};function ea(e){let i=(0,c.useContext)(x),s=()=>{var e;return null!==(e=i.user.profile.email)&&void 0!==e?e:"Unknown facilitator"},[n,t]=(0,c.useState)(),[l,o]=(0,c.useState)(),[d,u]=(0,c.useState)(!1),[h,p]=(0,c.useState)(),[v,g]=(0,c.useState)(),[m,j]=(0,c.useState)(),[b,y]=(0,c.useState)(),[Z,w]=(0,c.useState)(),[S,D]=(0,c.useState)(),[k,T]=(0,c.useState)(),[E,W]=(0,c.useState)(),[P,A]=(0,c.useState)(),[R,I]=(0,c.useState)(),[q,F]=(0,c.useState)(),[_,N]=(0,c.useState)(),[ee,ea]=(0,c.useState)(),[ed,ec]=(0,c.useState)(),[eu,eh]=(0,c.useState)(),[ex,ep]=(0,c.useState)();(0,c.useEffect)(()=>{var i,s;t(null!==(s=null===(i=e.prefill)||void 0===i?void 0:i.sessionSlug)&&void 0!==s?s:"")},[e.open,e.prefill]),(0,c.useEffect)(()=>{o(el.find(e=>e.slug===n))},[n,e.prefill]),(0,c.useEffect)(()=>{var i,n,t,o,r,a,d,c,h,x,v,m,b,Z,S,D,k;console.debug("selected template",l),p(null!==(Z=null===(i=e.prefill)||void 0===i?void 0:i.sessionName)&&void 0!==Z?Z:null==l?void 0:l.title),g(void 0),j(null!==(S=null===(n=e.prefill)||void 0===n?void 0:n.sessionDescription)&&void 0!==S?S:null==l?void 0:l.description),y(void 0),ea((null===(t=e.prefill)||void 0===t?void 0:t.sessionDurationMins)!==void 0?null===(o=e.prefill)||void 0===o?void 0:o.sessionDurationMins:null==l?void 0:l.duration_mins),ec(void 0),w((null===(r=e.prefill)||void 0===r?void 0:r.audience)!==void 0?null===(a=e.prefill)||void 0===a?void 0:a.audience:null==l?void 0:l.audience),T((null===(d=e.prefill)||void 0===d?void 0:d.remoteConfiguration)!==void 0?e.prefill.remoteConfiguration:void 0!==l?f.VS.InPerson:void 0),W(void 0),A((null!==(D=null===(c=e.prefill)||void 0===c?void 0:c.facilitatorEmail)&&void 0!==D?D:void 0!==l)?s():void 0),I(void 0),F((null===(h=e.prefill)||void 0===h?void 0:h.sessionStartTime)!==void 0?ei()(null===(x=e.prefill)||void 0===x?void 0:x.sessionStartTime):void 0!==l?ei()():void 0),N(void 0),eh((null!==(k=null===(v=e.prefill)||void 0===v?void 0:v.location)&&void 0!==k?k:void 0!==l)?"":void 0),ep((null===(m=e.prefill)||void 0===m?void 0:m.anticipatedParticipants)!==void 0?null===(b=e.prefill)||void 0===b?void 0:b.anticipatedParticipants:void 0!==l?12:void 0),u(void 0!==l)},[l,e.prefill]);let ef=()=>{let e=!0;return void 0===h||h.trim().length<1?(g("Title is required"),e=!1):g(void 0),void 0===m||m.trim().length<1?(y("Description is required"),e=!1):y(void 0),void 0===q?(N("Start date is required"),e=!1):N(void 0),void 0===ee||ee<1?(ec("Duration is required"),e=!1):ec(void 0),void 0===k?(W("Remote configuration is required"),e=!1):W(void 0),void 0===Z?(D("Audience is required"),e=!1):D(void 0),void 0===P||P.trim().length<1?(I("Facilitator is required"),e=!1):I(void 0),e},ev=()=>{e.busy||e.onCloseRequest()},eg=e=>(0,r.jsx)(en.ZP,{variant:"popover",popupId:e.id,children:i=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.Z,{sx:{alignSelf:"start"},"aria-label":e.description,...(0,et.LI)(i),children:(0,r.jsx)(es.Z,{})}),(0,r.jsx)(G.ZP,{...(0,et.ZW)(i),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,r.jsx)(C.Z,{sx:{p:1},children:e.children})})]})});return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(O.Z,{fullWidth:!0,maxWidth:"sm",open:e.open,onClose:ev,children:[(0,r.jsxs)(Q.Z,{children:[void 0!==e.prefill?"Edit":"Create new"," session",(0,r.jsx)(C.Z,{style:{position:"absolute",top:0,right:0},children:(0,r.jsx)(z.Z,{"aria-label":"close",onClick:ev,children:(0,r.jsx)(X.Z,{})})})]}),(0,r.jsx)(L.Z,{children:(0,r.jsxs)(C.Z,{sx:{p:1},display:"flex",flexDirection:"column",alignItems:"stretch",gap:2,children:[(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsxs)(U.Z,{fullWidth:!0,children:[(0,r.jsx)(M.Z,{id:"new-session-template-label",children:"Workshop"}),(0,r.jsx)(V.Z,{labelId:"new-session-template-label",value:null!=n?n:"",label:"Workshop",required:!0,disabled:e.busy,onChange:e=>t(e.target.value),children:el.map(e=>(0,r.jsx)(B.Z,{value:e.slug,children:e.title},"session-template-option-".concat(e.slug)))})]})}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:[(0,r.jsxs)(U.Z,{fullWidth:!0,children:[(0,r.jsx)(M.Z,{id:"new-session-audience-label",children:"Audience"}),(0,r.jsx)(V.Z,{labelId:"new-session-audience-label",value:null!=Z?Z:"",label:"Audience",required:!0,disabled:!d||e.busy,onChange:e=>w(e.target.value),children:eo.map(e=>(0,r.jsx)(B.Z,{value:e.value,children:e.title},"session-audience-option-".concat(e.value)))})]}),(0,r.jsxs)(eg,{id:"session-audience-info-popup",description:"Workshop audience info",children:[(0,r.jsx)("p",{children:"Choose between:"}),(0,r.jsx)("ul",{children:eo.map(e=>(0,r.jsxs)("li",{children:[(0,r.jsx)("b",{children:e.title}),": ",e.description]},"session-audience-info-".concat(e.value)))})]})]}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(Y.Z,{fullWidth:!0,label:"Session title",value:null!=h?h:"",required:!0,onChange:e=>p(e.target.value),disabled:!d||e.busy,error:!!v,helperText:v})}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(Y.Z,{fullWidth:!0,label:"Session description",value:null!=m?m:"",required:!0,onChange:e=>j(e.target.value),disabled:!d||e.busy,error:!!b,helperText:b})}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(J._,{dateAdapter:$.y,children:(0,r.jsx)(K.x,{label:"Session start",value:void 0!==q?q:null,onChange:e=>F(null!=e?e:void 0),disabled:!d||e.busy,slotProps:{textField:{fullWidth:!0,required:!0,error:!!_,helperText:_}}})})}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(Y.Z,{fullWidth:!0,inputProps:{type:"number"},label:"Duration (mins)",value:null!=ee?ee:"",required:!0,onChange:e=>ea(er(e.target.value)),disabled:!d||e.busy,error:!!ed,helperText:ed})}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:[(0,r.jsxs)(U.Z,{fullWidth:!0,children:[(0,r.jsx)(M.Z,{id:"new-session-remote-config-label",children:"Remote configuration"}),(0,r.jsxs)(V.Z,{labelId:"new-session-remote-config-label",value:null!=k?k:"",label:"Remote configuration",required:!0,onChange:e=>T(e.target.value),disabled:!d||e.busy,error:!!E,children:[(0,r.jsx)(B.Z,{value:f.VS.InPerson,children:"In person"}),(0,r.jsx)(B.Z,{value:f.VS.Remote,children:"Remote"}),(0,r.jsx)(B.Z,{value:f.VS.RemoteWithVideoCall,children:"Remote (with video call)"})]})]}),(0,r.jsx)(eg,{id:"remote-config-info-popup",description:"Remote configuration info",children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"In person: Audio plays from facilitator only"}),(0,r.jsx)("li",{children:"Remote: Audio plays from all devices"}),(0,r.jsx)("li",{children:"Remote with video call: Audio plays from all devices, embedded video call"})]})})]}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(Y.Z,{fullWidth:!0,label:"Facilitator",value:null!=P?P:"",onChange:e=>A(e.target.value),required:!0,disabled:!d||e.busy,error:!!R,helperText:R})}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(Y.Z,{fullWidth:!0,label:"Location",value:null!=eu?eu:"",onChange:e=>eh(e.target.value),disabled:!d||e.busy})}),(0,r.jsx)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:(0,r.jsx)(Y.Z,{fullWidth:!0,label:"Anticipated participants",inputProps:{type:"number"},value:null!=ex?ex:"",onChange:e=>ep(er(e.target.value)),disabled:!d||e.busy})})]})}),(0,r.jsxs)(H.Z,{children:[(0,r.jsx)(a.Z,{variant:"outlined",onClick:ev,disabled:e.busy,children:"Cancel"}),(0,r.jsx)(a.Z,{variant:"outlined",onClick:()=>{e.onClearRequest(),t(void 0)},disabled:e.busy,children:"Clear"}),(0,r.jsx)(a.Z,{variant:"contained",onClick:()=>{if(ef()){var i,s,n,t,o,r;let a={...e.prefill,id:null===(i=e.prefill)||void 0===i?void 0:i.id,sessionName:h,sessionDescription:m,sessionSlug:l.slug,sessionStartTime:q.set("second",0).toDate(),sessionDurationMins:ee,remoteConfiguration:k,facilitatorEmail:P,location:eu,anticipatedParticipants:ex,sessionGraphicAltText:null===(s=e.prefill)||void 0===s?void 0:s.sessionGraphicAltText,sessionPresentationUris:l.uris,answers:null!==(r=null===(n=e.prefill)||void 0===n?void 0:n.answers)&&void 0!==r?r:[],audience:Z,facilitationState:(null===(t=e.prefill)||void 0===t?void 0:t.facilitationState)!==void 0?e.prefill.facilitationState:f._y.Ready,fullScreen:(null===(o=e.prefill)||void 0===o?void 0:o.fullScreen)===void 0||e.prefill.fullScreen};e.onSubmitRequest(a)}},disabled:e.busy,children:"Submit"})]})]})})}let ed=e=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"][e];function ec(){let e=(0,c.useContext)(S.A),i=(0,c.useContext)(x),[s,n]=(0,c.useState)(!1),[t,l]=(0,c.useState)([]),[o,d]=(0,c.useState)({}),[u,h]=(0,c.useState)({}),[p,g]=(0,c.useState)(),[y,Z]=(0,c.useState)(!1),[w,R]=(0,c.useState)(!1),[I,q]=(0,c.useState)(""),[F,_]=(0,c.useState)(),[O,L]=(0,c.useState)(!1),z=(0,A.useSearchParams)(),[G,Q]=(0,c.useState)(0);(0,c.useEffect)(()=>{let e=z.get("flags"),i=0;e&&(e.includes("m")&&(i|=2),e.includes("a")&&(i|=1),Q(i))},[z]);let U=()=>{t.forEach(i=>{let s=(0,D.X)(i.sessionPresentationUris[0]);if(!o.hasOwnProperty(s)){let n={workshopDirectory:s};e.getPublicContentAccessUrls(i.id,n).then(e=>{d(i=>{let s={...i};return s[n.workshopDirectory]={thumb:e.thumbnailUrl,poster:e.posterUrl},s})})}})},M=e=>{var i;let s=(0,D.X)(e.sessionPresentationUris[0]),n=o.hasOwnProperty(s)?o[s]:void 0;return null!==(i=null==n?void 0:n.thumb)&&void 0!==i?i:null==n?void 0:n.poster},V=e=>{let i={};return e.forEach(e=>{let s=new Date(e.sessionStartTime).toLocaleDateString("en-GB",{month:"long",year:"numeric"});i[s]||(i[s]=[]),i[s].push(e)}),console.debug("sessions grouped by month",i),i},B=async()=>{try{console.debug("Fetching sessions..."),l([]),n(!0);let s=await e.listDeliberationSessions(i.user.access_token);console.debug("Sessions",s);let t=s.filter(e=>e.audience!==f.EQ.AutomatedTests||1&G&&e.audience===f.EQ.AutomatedTests).toSorted((e,i)=>new Date(e.sessionStartTime).getTime()-new Date(i.sessionStartTime).getTime());l(t)}catch(e){console.error(e)}finally{n(!1)}};(0,c.useEffect)(()=>{g(void 0),U(),h(V(t))},[t]),(0,c.useEffect)(()=>{B()},[]);let Y=async s=>{console.debug("New session submitted",s);try{if(L(!0),!(void 0===s.id?await e.postDeliberationSessionAdmin(i.user.access_token,s):await e.putDeliberationSessionAdmin(i.user.access_token,s)).id)throw"Session creation failed.";Z(!1),q("Session submitted successfully."),R(!0),B()}catch(e){console.error(e),q("Session submission failed. Please contact support."),R(!0)}finally{L(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ea,{open:y,busy:O,onCloseRequest:()=>{Z(!1)},onClearRequest:()=>{_(void 0)},onSubmitRequest:Y,prefill:F}),(0,r.jsx)(k.Z,{open:w,autoHideDuration:6e3,onClose:()=>R(!1),message:I}),(0,r.jsxs)(v.ZP,{container:!0,children:[(0,r.jsxs)(v.ZP,{item:!0,xs:6,sx:{px:2},children:[(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,r.jsx)(b.Z,{variant:"h4",children:"Workshops"}),(0,r.jsxs)(C.Z,{display:"flex",flexDirection:"row",gap:1,children:[(0,r.jsx)(a.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{_(void 0),Z(!0)},disabled:s,children:"Add"}),(0,r.jsx)(a.Z,{variant:"outlined",color:"buttonStandard",onClick:()=>{B()},disabled:s,children:"Refresh"})]})]}),s&&(0,r.jsx)(T.Z,{}),(0,r.jsx)(m.Z,{subheader:(0,r.jsx)("li",{}),children:!!u&&Object.keys(u).map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("ul",{children:[(0,r.jsx)(E.Z,{style:{background:"transparent"},sx:{mt:2},children:(0,r.jsx)(b.Z,{variant:"h6",children:e})}),u[e].map((e,i)=>(0,r.jsxs)(j.Z,{alignItems:"center",onClick:()=>g(e),selected:(null==p?void 0:p.id)===e.id,children:[(0,r.jsxs)(C.Z,{sx:{px:1,m:1,textAlign:"center",borderRight:"solid 2px lightGray"},children:[(0,r.jsx)(b.Z,{variant:"body2",children:ed(new Date(e.sessionStartTime).getDay())}),(0,r.jsx)(b.Z,{variant:"h4",children:new Date(e.sessionStartTime).getDate()})]}),(0,r.jsx)(W.Z,{primary:(0,r.jsx)(C.Z,{sx:{mb:.5},children:e.sessionName}),secondary:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(C.Z,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[(0,r.jsxs)(C.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:.5,rowGap:.5},children:[(0,r.jsx)(P.Z,{component:"span",size:"small",label:f._y[e.facilitationState],color:"primary"}),(0,r.jsx)(P.Z,{component:"span",size:"small",label:f.VS[e.remoteConfiguration],color:"primary"}),(0,r.jsx)(P.Z,{component:"span",size:"small",label:f.EQ[e.audience],color:"primary"}),(0,r.jsx)(P.Z,{component:"span",size:"small",label:new Date(e.sessionStartTime).toLocaleTimeString(),color:"primary"})]}),(0,r.jsxs)(C.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:.5,rowGap:.5},children:[e.facilitatorEmail&&(0,r.jsx)(P.Z,{component:"span",size:"small",label:e.facilitatorEmail,color:"secondary"}),e.location&&(0,r.jsx)(P.Z,{component:"span",size:"small",label:e.location,color:"secondary"})]})]})})}),M(e)&&(0,r.jsx)("img",{style:{maxWidth:100,maxHeight:100},src:M(e),alt:e.sessionGraphicAltText})]},"session-button-".concat(i)))]})},"overview-month-".concat(e)))})]}),(0,r.jsx)(v.ZP,{item:!0,xs:6,sx:{px:2},children:p&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(N,{session:p,onEditSession:e=>{_(e),Z(!0)},onDeleteSession:e=>{}})})})]})]})}function eu(){let[e,i]=(0,c.useState)(l.Workshops),[s,n]=(0,c.useState)((0,r.jsx)(ec,{}));return(0,c.useEffect)(()=>{void 0!==document&&(document.title="Facilitator overview")},[]),(0,c.useEffect)(()=>{if(e===l.Workshops)n((0,r.jsx)(ec,{}));else throw"".concat(l[e]," not implemented.")},[e]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(S.Z,{children:(0,r.jsx)(p,{role:f._b.Controller,children:(0,r.jsx)(g,{sx:{background:"linear-gradient(270deg, rgba(0, 0, 255, 0.25) 0%, rgba(0, 0, 255, 0.00) 50%, rgba(0, 0, 255, 0.00) 100%)"},menu:(0,r.jsx)(w,{options:[l.Workshops],onSetSelection:i,showUsername:!0,showSignOut:!1}),children:s})})})})}(t=o||(o={}))[t.ShowAutomatedTesting=1]="ShowAutomatedTesting",t[t.ShowManualTesting=2]="ShowManualTesting"},10105:function(e,i,s){"use strict";s.d(i,{k:function(){return t},v:function(){return n}});let n=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),t=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)}},function(e){e.O(0,[732,887,403,42,181,280,842,13,971,23,744],function(){return e(e.s=7251)}),_N_E=e.O()}]);
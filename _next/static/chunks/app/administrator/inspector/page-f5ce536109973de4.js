(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{78005:function(e,t,s){Promise.resolve().then(s.bind(s,11255))},68935:function(e,t,s){"use strict";s.d(t,{Z:function(){return w}});var n=s(23950),i=s(22988),o=s(2265),a=s(44839),r=s(87542),c=s(26259),l=s(41259),d=s(48762),u=s(47794),h=s(13143),p=s(57437);let m=["className","component","disableGutters","fixed","maxWidth","classes"],g=(0,h.Z)(),b=(0,u.Z)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:s}=e;return[t.root,t[`maxWidth${(0,l.Z)(String(s.maxWidth))}`],s.fixed&&t.fixed,s.disableGutters&&t.disableGutters]}}),S=e=>(0,d.Z)({props:e,name:"MuiContainer",defaultTheme:g}),f=(e,t)=>{let{classes:s,fixed:n,disableGutters:i,maxWidth:o}=e,a={root:["root",o&&`maxWidth${(0,l.Z)(String(o))}`,n&&"fixed",i&&"disableGutters"]};return(0,c.Z)(a,e=>(0,r.ZP)(t,e),s)};function w(e={}){let{createStyledComponent:t=b,useThemeProps:s=S,componentName:r="MuiContainer"}=e,c=t(({theme:e,ownerState:t})=>(0,i.Z)({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}),({theme:e,ownerState:t})=>t.fixed&&Object.keys(e.breakpoints.values).reduce((t,s)=>{let n=e.breakpoints.values[s];return 0!==n&&(t[e.breakpoints.up(s)]={maxWidth:`${n}${e.breakpoints.unit}`}),t},{}),({theme:e,ownerState:t})=>(0,i.Z)({},"xs"===t.maxWidth&&{[e.breakpoints.up("xs")]:{maxWidth:Math.max(e.breakpoints.values.xs,444)}},t.maxWidth&&"xs"!==t.maxWidth&&{[e.breakpoints.up(t.maxWidth)]:{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`}}));return o.forwardRef(function(e,t){let o=s(e),{className:l,component:d="div",disableGutters:u=!1,fixed:h=!1,maxWidth:g="lg"}=o,b=(0,n.Z)(o,m),S=(0,i.Z)({},o,{component:d,disableGutters:u,fixed:h,maxWidth:g}),w=f(S,r);return(0,p.jsx)(c,(0,i.Z)({as:d,ownerState:S,className:(0,a.Z)(w.root,l),ref:t},b))})}},11255:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var n=s(57437),i=s(2265),o=s(69026),a=s(80511),r=s(96537),c=s(44908),l=s(65786),d=s(20920),u=s(95107),h=s(16463),p=s(67022),m=s(94547);let g=(0,s(68935).Z)();(0,d.Z)();let b={id:void 0,created:void 0,sessionName:"test session",sessionDescription:"a test session",sessionSlug:"test",creatorSub:void 0,joinCode:void 0,sessionPresentationUris:["/workshops/dev-testing/presentation.xml"],sessionStartTime:new Date,sessionDurationMins:20,remoteConfiguration:m.VS.InPerson,chimeMeetingDataId:void 0,chimeMeetingData:void 0,answers:[],audience:m.EQ.LiveWorkshop,facilitationState:m._y.Ready,fullScreen:!0,sessionStartedAt:void 0,facilitatorEmail:"lewis.westbury@nesta.org.uk",location:void 0,documentation:void 0,anticipatedParticipants:12},S=[{name:"Zeitgeist demo",description:"A Zeitgeist demonstration workshop.",slug:"zg-demo",alt:"Illustrative graphic",uris:["/workshops/zg-demo/presentation.xml"],remote:m.VS.Remote},{name:"Zeitgeist gallery",description:"A multi-module gallery workshop, illustrating the various input and visualisation components that the Zeitgeist platform offers.",slug:"zg-gallery",alt:"Illustrative graphic",uris:["/workshops/zg-welcome/presentation.xml","/workshops/zg-gallery/presentation.xml"],remote:m.VS.Remote},{name:"Options 2040 demo",description:"A demonstration session, illustrating The Strategy Room content, combined with Options 2040 branding.",slug:"options-demo",alt:"Illustrative graphic",uris:["/workshops/options-transport/presentation.xml"],remote:m.VS.Remote},{name:"DSIT demo",description:"An illustrative demo session, combining pre-existing content and DSIT branding.",slug:"dsit-demo",alt:"Illustrative graphic",uris:["/workshops/dsit-demo/presentation.xml"],remote:m.VS.Remote}],f=()=>w(S[0].name,S[0].description,S[0].uris,S[0].slug,S[0].alt,S[0].remote),w=(e,t,s,n,i,o)=>{let a=structuredClone(b);return a.sessionName=e,a.sessionDescription=t,a.remoteConfiguration=o,a.sessionPresentationUris=s,a.sessionSlug=n,a.sessionGraphic=void 0,a.sessionGraphicAltText=i,a};function x(){let[e,t]=(0,i.useState)([]),[s,d]=(0,i.useState)([]),[x,y]=(0,i.useState)(),[k,v]=(0,i.useState)({sessionId:""}),[T,C]=(0,i.useState)(JSON.stringify(f(),null,2)),[j,A]=(0,i.useState)(!0),[D,O]=(0,i.useState)(!0),[N,Z]=(0,i.useState)(!1),J=(0,i.useRef)(null);(0,h.useRouter)();let P=(0,p.aC)(),U=new o.Z("https://hf3n3vkh6g.execute-api.eu-west-2.amazonaws.com/prod");(0,i.useEffect)(()=>{void 0!==document&&(document.title="Zg Admin: Inspector")},[]);let I=()=>{J.current.disabled=!0,U.listDeliberationSessions(P.user.access_token,m.yI.All).then(e=>{console.log("sessions",e),t(e)}).catch(e=>{console.error("error",e)}).finally(()=>{J.current.disabled=!1})},R=e=>{var t;U.getDeliberationSessionAdmin(e,null===(t=P.user)||void 0===t?void 0:t.access_token).then(e=>{console.log("session",e),y(e),v({...k,sessionId:e.id})}).catch(e=>{console.error("error",e)})};(0,i.useEffect)(()=>{C(JSON.stringify(x,null,2))},[x]);let E=e=>{U.postDeliberationSessionAdmin(P.user.access_token,e).then(e=>{console.log("session",e),y(e),v({...k,sessionId:e.id}),I()}).catch(e=>{console.error("error",e)})},G=e=>{U.putDeliberationSessionAdmin(P.user.access_token,e).then(e=>{console.log("session",e),y(e),v({...k,sessionId:e.id}),I()}).catch(e=>{console.error("error",e)})},W=(e,t)=>{y(b),v({...k,sessionId:e}),R(e)},z=e=>{if(!e)return f();let t={...b};return t.id=void 0,t.answers=[],t.sessionName=e.sessionName+" (copy)",t.sessionDescription=e.sessionDescription,t.sessionGraphic=e.sessionGraphic,t.sessionSlug=e.sessionSlug,t.sessionPresentationUris=e.sessionPresentationUris,t.facilitationState=m._y.Ready,t.sessionStartedAt=void 0,t.sessionStartTime=new Date,t};return(0,i.useEffect)(()=>{d(e.filter(e=>e.audience!==m.EQ.AutomatedTests||!!N&&e.audience===m.EQ.AutomatedTests))},[e,j,D,N]),(0,n.jsxs)(g,{maxWidth:!1,children:[(0,n.jsx)(a.Z,{variant:"h1",children:"Zeitgeist admin"}),!!P.isAuthenticated&&(0,n.jsxs)(a.Z,{variant:"body2",children:["Signed in as: ",P.user.profile.email]}),(0,n.jsx)(a.Z,{variant:"body1",children:"A rough and ready admin backend."}),(0,n.jsxs)("p",{children:[!P.isAuthenticated&&(0,n.jsx)(r.Z,{variant:"contained",onClick:()=>{P.signinRedirect()},children:"Sign in"}),!!P.isAuthenticated&&(0,n.jsx)(r.Z,{variant:"outlined",onClick:()=>{P.signoutRedirect()},children:"Sign out"})]}),(0,n.jsxs)(a.Z,{variant:"h2",children:[e.length," Deliberation sessions"]}),(0,n.jsxs)("div",{children:[!!P.isAuthenticated&&(0,n.jsx)(r.Z,{variant:"contained",ref:J,onClick:()=>{I()},children:"Fetch"}),!P.isAuthenticated&&(0,n.jsx)("p",{children:"Sign in to fetch all sessions"})]}),(0,n.jsx)(c.Z,{control:(0,n.jsx)(l.Z,{checked:j,onChange:e=>{A(e.target.checked)}}),label:"Show public sessions"}),(0,n.jsx)(c.Z,{control:(0,n.jsx)(l.Z,{checked:D,onChange:e=>{O(e.target.checked)}}),label:"Show testing sessions"}),(0,n.jsx)(c.Z,{control:(0,n.jsx)(l.Z,{checked:N,onChange:e=>{Z(e.target.checked)}}),label:"Show sessions for automatic testing"}),e.length>0&&(0,n.jsx)(u._,{autoHeight:!0,rows:s,columns:[{field:"id",headerName:"Id",width:300},{field:"sessionStartTime",headerName:"Starts",width:250,valueGetter:(e,t)=>new Date(e).toLocaleString()},{field:"sessionName",headerName:"Name",width:350},{field:"facilitationState",headerName:"State",width:100,valueGetter:(e,t)=>m._y[e]},{field:"joinCode",headerName:"Join code",width:100},{field:"remoteConfiguration",headerName:"Remote",width:150,valueGetter:(e,t)=>m.VS[e]}],onRowClick:e=>{W(e.row.id,e.row.joinCode)},initialState:{pagination:{paginationModel:{page:0,pageSize:25}}},pageSizeOptions:[25,50,75,100,150,200]}),(0,n.jsx)(a.Z,{variant:"h2",children:"Inspector"}),(0,n.jsx)(a.Z,{variant:"h3",children:"Get session"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("input",{name:"sessionId",type:"text",value:k.sessionId,onChange:e=>{v({...k,[e.target.name]:e.target.value})}}),(0,n.jsx)(r.Z,{variant:"contained",onClick:()=>{R(k.sessionId)},children:"Get session"}),(0,n.jsx)("br",{})]}),(0,n.jsx)(a.Z,{variant:"h3",children:"Create session"}),(0,n.jsx)("p",{children:S.map((e,t)=>(0,n.jsxs)(r.Z,{variant:"outlined",onClick:()=>{y(w(e.name,e.description,e.uris,e.slug,e.alt,e.remote))},children:["New ",e.name]},"btn-new-".concat(e.name)))}),(0,n.jsxs)("div",{children:[(0,n.jsx)("textarea",{value:T,rows:24,cols:100,onChange:e=>{C(e.target.value)}}),P.isAuthenticated&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)(r.Z,{variant:"outlined",onClick:()=>{y(z(x))},children:"Duplicate session"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(r.Z,{variant:"contained",onClick:()=>{console.log("currentSessionJson",T),E(JSON.parse(T))},disabled:!(()=>{try{return!!JSON.parse(null!=T?T:"{}")}catch(e){return!1}})(),children:"Create session"}),(0,n.jsx)(r.Z,{variant:"contained",onClick:()=>{console.log("currentSessionJson",T),G(JSON.parse(T))},disabled:!(()=>{try{var e;return(null===(e=JSON.parse(null!=T?T:"{}"))||void 0===e?void 0:e.id)!==void 0}catch(e){return!1}})(),children:"Update session"})]})]})]})}},69026:function(e,t,s){"use strict";s.d(t,{N:function(){return i},Z:function(){return o}});var n=s(94547);let i=(e,t)=>{let{sid:s,pid:n,qid:i}=e;return{id:void 0,created:void 0,questionId:i,participantId:n,jsonValue:void 0,mimeType:void 0,pII:t}};class o{async getServerTime(){return console.debug("getServerTime"),new Promise(async(e,t)=>{let s=await fetch("".concat(this.baseUri,"/utils/servertime"),{method:"GET",headers:{"Content-Type":"application/json"}});s.ok?e(JSON.parse(await s.text())):t(s.statusText)})}async postDeliberationSessionAdmin(e,t){return console.debug("postDeliberationSessionAdmin"),new Promise(async(s,n)=>{let i={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)},o=await fetch("".concat(this.baseUri,"/sessions/admin"),i);o.ok?s(JSON.parse(await o.text())):n(o.statusText)})}async putDeliberationSessionAdmin(e,t){return console.debug("putDeliberationSessionAdmin"),new Promise(async(s,n)=>{let i={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)},o=await fetch("".concat(this.baseUri,"/sessions/admin/").concat(t.id),i);o.ok?s(JSON.parse(await o.text())):n(o.statusText)})}async postFacilitatorAction(e,t,s){return console.debug("postFacilitatorAction",s.action),new Promise(async(n,i)=>{let o={method:"POST",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":t,Authorization:"Bearer ".concat(e)},body:JSON.stringify(s)},a=await fetch("".concat(this.baseUri,"/sessions/admin/actions/").concat(s.sessionId),o);a.ok?n(JSON.parse(await a.text())):i(a.statusText)})}async getDeliberationSessionAdmin(e,t){return console.debug("getDeliberationSessionAdmin",e,t?"(with access token)":""),new Promise(async(s,n)=>{let i={method:"GET",headers:{"Content-Type":"application/json"}};t&&(i.headers.Authorization="Bearer ".concat(t));let o=await fetch("".concat(this.baseUri,"/sessions/admin/").concat(e),i);o.ok?s(JSON.parse(await o.text())):n(o.statusText)})}async listDeliberationSessions(e,t){console.debug("listDeliberationSessions",n.yI[t]);let s=await fetch("".concat(this.baseUri,"/sessions/list/").concat(n.yI[t]),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(s.ok){let e=JSON.parse(await s.text());return console.debug("Retrieved ".concat(e.length," sessions")),e}throw s.statusText}async getDeliberationSession(e,t){return console.debug("getDeliberationSession",e,t?"(with access token)":""),new Promise(async(s,n)=>{let i={method:"GET",headers:{"Content-Type":"application/json"}};t&&(i.headers.Authorization="Bearer ".concat(t));let o=await fetch("".concat(this.baseUri,"/sessions/").concat(e),i);o.ok?s(JSON.parse(await o.text())):n(o.statusText)})}async retrieveMeetingAttendeeData(e,t,s,n,i){console.debug("getDeliberationSessionMeeting");let o={name:n,participantId:s};return new Promise(async(s,n)=>{let a="".concat(this.baseUri,"/sessions/").concat(e,"/attendee"),r={method:"POST",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":t},body:JSON.stringify(o)};i&&(r.headers.Authorization="Bearer ".concat(i),a="".concat(this.baseUri,"/sessions/admin/").concat(e,"/attendee"));let c=await fetch(a,r);c.ok?s(JSON.parse(await c.text())):n(c.statusText)})}async exchangeJoinCodeForSessionToken(e){return console.debug("exchangeJoinCodeForSessionToken"),new Promise(async(t,s)=>{let n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},i=e.sessionId,o=await fetch("".concat(this.baseUri,"/sessions/").concat(i,"/token"),n);o.ok?t(JSON.parse(await o.text())):s(o.statusText)})}async postDeliberationAnswer(e,t,s){console.debug("postDeliberationAnswer",t);let n=t.questionId;return new Promise(async(i,o)=>{let a={method:"POST",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":s},body:JSON.stringify(t)},r=await fetch("".concat(this.baseUri,"/sessions/").concat(e,"/questions/").concat(n,"/answers"),a);r.ok?i(JSON.parse(await r.text())):o(r.statusText)})}async getDeliberationAnswer(e,t,s,n){return console.debug("getDeliberationAnswer",e,t,s),new Promise(async(i,o)=>{let a=await fetch("".concat(this.baseUri,"/sessions/").concat(e,"/questions/").concat(t,"/answers?pid=").concat(s),{method:"GET",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":n}});if(a.ok){let n=JSON.parse(await a.text());n.length>1&&o("".concat(n.length," answers returned for sid: ").concat(e,", qid: ").concat(t,", pid: ").concat(s," - there should be 0 or 1")),i(0==n.length?null:n[0])}else o(a.statusText)})}async getDeliberationAnswersForQuestion(e,t,s){return console.debug("getDeliberationAnswersForQuestion",e,t),new Promise(async(n,i)=>{let o=await fetch("".concat(this.baseUri,"/sessions/").concat(e,"/questions/").concat(t,"/answers"),{method:"GET",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":s}});o.ok?n(JSON.parse(await o.text())):i(o.statusText)})}async getDeliberationAnswersForParticipant(e,t,s){return console.debug("getDeliberationAnswersForParticipant",e,t),new Promise(async(n,i)=>{let o=await fetch("".concat(this.baseUri,"/sessions/").concat(e,"/participants/").concat(t,"/answers"),{method:"GET",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":s}});o.ok?n(JSON.parse(await o.text())):i(o.statusText)})}async getSessionContentAccessUrls(e,t,s){return console.debug("Retrieving ".concat(s.objectKeys.length," session content access URLs...")),new Promise(async(n,i)=>{let o={method:"POST",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":t},body:JSON.stringify(s)},a=await fetch("".concat(this.baseUri,"/sessions/").concat(e,"/content"),o);a.ok?n(JSON.parse(await a.text())):i(a.statusText)})}async getPublicContentAccessUrls(e,t){return console.debug("Retrieving public content access URLs for ".concat(t.workshopDirectory,"...")),new Promise(async(s,n)=>{let i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},o=await fetch("".concat(this.baseUri,"/sessions/").concat(e,"/content/public"),i);o.ok?s(JSON.parse(await o.text())):n(o.statusText)})}async getReport(e,t,s){console.debug("getReport",e,n.gY[s]);let i="".concat(this.baseUri,"/sessions/admin/").concat(e,"/report/").concat(n.gY[s]),o=await fetch(i,{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(o.ok)return JSON.parse(await o.text());throw o.statusText}async getMediaUploadUrl(e,t,s,n,i,o){console.debug("getMediaUploadUrl");let a="".concat(this.baseUri,"/sessions/admin/").concat(e,"/upload"),r={method:"POST",headers:{"Content-Type":"application/json","X-Deliberation-Session-Token":t},body:JSON.stringify({sessionId:e,section:n,filenamePart:i,filenameSuffix:o})};r.headers.Authorization="Bearer ".concat(s);let c=await fetch(a,r);if(c.ok)return JSON.parse(await c.text());throw c.statusText}async putBlob(e,t){if(console.debug("putBlob",t),0===e.size)throw"Blob is empty";console.debug("Ready to upload ".concat(e.size," bytes..."));let s=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:e});if(s.ok)return!0;throw s.statusText}constructor(e){this.baseUri=e}}},94547:function(e,t,s){"use strict";var n,i,o,a,r,c,l,d,u,h,p,m,g,b,S,f;s.d(t,{EQ:function(){return i},SC:function(){return d},VS:function(){return a},_b:function(){return n},_y:function(){return o},gY:function(){return c},um:function(){return r},yI:function(){return l}}),(u=n||(n={}))[u.Controller=0]="Controller",u[u.Client=1]="Client",(h=i||(i={}))[h.LiveWorkshop=0]="LiveWorkshop",h[h.AutomatedTests=1]="AutomatedTests",h[h.TestingWorkshop=2]="TestingWorkshop",h[h.DemoWorkshop=3]="DemoWorkshop",(p=o||(o={}))[p.Absent=0]="Absent",p[p.Ready=1]="Ready",p[p.Open=2]="Open",p[p.Closed=3]="Closed",(m=a||(a={}))[m.InPerson=0]="InPerson",m[m.Remote=1]="Remote",m[m.RemoteWithVideoCall=2]="RemoteWithVideoCall",(g=r||(r={}))[g.Offline=0]="Offline",g[g.Online=1]="Online",g[g.Connecting=2]="Connecting",g[g.Connected=3]="Connected",g[g.Joining=4]="Joining",g[g.Joined=5]="Joined",g[g.Disconnecting=6]="Disconnecting",g[g.Disconnected=7]="Disconnected",g[g.Error=8]="Error",(b=c||(c={}))[b.ContactAndConsent=0]="ContactAndConsent",b[b.EnjoymentAndSatisfaction=1]="EnjoymentAndSatisfaction",(S=l||(l={}))[S.All=0]="All",S[S.Upcoming=1]="Upcoming",S[S.Past=2]="Past",S[S.Answered=3]="Answered",(f=d||(d={})).facilitators="facilitators",f.analysts="analysts",f.administrators="administrators"}},function(e){e.O(0,[732,887,403,465,516,107,971,23,744],function(){return e(e.s=78005)}),_N_E=e.O()}]);